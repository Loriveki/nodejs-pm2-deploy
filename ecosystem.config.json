{
  "apps": [
    {
      "name": "mesto-backend",
      "script": "npm",
      "args": "run start",
      "cwd": "./backend",
      "env": {
        "NODE_ENV": "production"
      }
    },
    {
      "name": "mesto-frontend",
      "script": "npx",
      "args": "serve -s build -l 3001",
      "cwd": "./frontend",
      "env": {
        "NODE_ENV": "production"
      }
    }
  ],

  "deploy": {
    "production": {
      "user": "${DEPLOY_USER}",
      "host": "${DEPLOY_HOST}",
      "ref": "origin/review",
      "repo": "${DEPLOY_REPO}",
      "path": "${DEPLOY_PATH}",
      "ssh_options": "IdentityFile=${DEPLOY_SSH_KEY}",
      "post-deploy": "scp ./backend/.env ${DEPLOY_USER}@${DEPLOY_HOST}:${DEPLOY_PATH}/current/backend/.env && cd backend && npm install && pm2 reload ecosystem.config.json --env production && cd ../frontend && npm install && npm run build"
    }
  }
}
